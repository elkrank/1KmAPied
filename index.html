<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Accueil</title>
</head>
<body>
    <nav>
        <a href="index.html">Accueil</a>
        <a href="">à propos</a>
        <a href="carte-1km.html">1km</a>
        <a href="carte-2km.html">2km</a>
        <a href="carte-3km.html">3km</a>
        <a href="carte-4km.html">4km</a>
    </nav>
    <input type="text" name="adress" id="adress">
    <button onclick="geocode()">Valider</button>
</body>
<script>
    
	
		
	//clé API graphhopper geocoding
	var defaultKey = "9abef042-bba4-4ca2-8ca7-071d2e0185c7";
	function geocode(){
		storageCoord = localStorage;
		//storageCoord.clear();
		
		var adresse = document.getElementById("adress").value; //récupère l'adresse du formulaire
		//Url de la requête
		var url="https://graphhopper.com/api/1/geocode?q="+adresse+"&locale=fr&debug=true&provider=opencagedata&key="+defaultKey;

		//Récupérer json depuis l'url de la requête.
		function Get(url){
			var Httpreq = new XMLHttpRequest(); // a new request
			Httpreq.open("GET",url,false);
			Httpreq.send(null);
			return Httpreq.responseText;          
		}
		var json_obj = JSON.parse(Get(url));
		console.log(json_obj);
		//Récupérer coordonnées depuis le json.
		var lat = json_obj.hits[0].point.lat;
		var lon = json_obj.hits[0].point.lng;
		
		
		storageCoord.setItem('lat', lat);
		storageCoord.setItem('lon', lon);
		console.log(lat);
	}
</script>
</html>
