<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Accueil</title>
</head>
<body>
    <nav>
        <a href="">Accueil</a>
        <a href="">à propos</a>
        <a href="carte-1km.html">1km</a>
        <a href="carte-2km.html">2km</a>
        <a href="carte-3km.html">3km</a>
        <a href="carte-4km.html">4km</a>
    </nav>
    <form action="">
        <input type="text" name="adress" id="adress">
        <input type="submit" value="valider">
    </form>
</body>
<script>
    //  recuperre l'adresse   stockage dans q
	//clé API graphhopper geocoding
	var defaultKey = "6d332a7e-45c5-4377-90de-cd9665ae1540";
	function geocode(){
		storageCoord = localStorage;
		storageCoord.clear();
		
		var adresse = document.getElementById("adress").value; //récupère l'adresse du formulaire
		//Url de la requête
		var url="https://graphhopper.com/api/1/geocode?q="+adresse+"&locale=fr&debug=true&provider=opencagedata&key="+defaultKey;

		//Récupérer json depuis l'url de la requête.
		function Get(url){
			var Httpreq = new XMLHttpRequest(); // a new request
			Httpreq.open("GET",url,false);
			Httpreq.send(null);
			return Httpreq.responseText;          
		}
		var json_obj = JSON.parse(Get(url));
		
		//Récupérer coordonnées depuis le json.
		var lat = json_obj.hits[0].point.lat;
		var lon = json_obj.hits[0].point.lng;
		
		
		storageCoord.setItem('lat', lat);
		storageCoord.setItem('lon', lon);
	}
</script>
</html>
